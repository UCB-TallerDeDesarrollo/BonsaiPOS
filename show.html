<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<title>BonsaiPOS</title>
<script>
window.$ = window.jQuery = require('./libs/jquery.min.js');
</script>
<style>
table, th, td {
    border: 1px solid black;
    border-collapse: collapse;
}
th, td {
    padding: 5px;
    text-align: left;
}
</style>
</head>

<body>

<h1>Nueva Venta</h1>
<form id="form1">
<input type="number" name="code" id="code_product" placeholder="Codigo del Producto"/>
<button>Anadir</button>
<button>Confirmar</button>
</form>
<table style="width:100%" id="tblDatos">
  <tr>
    <th>Codigo</th>
    <th>Nombre del producto</th>
    <th>Cantidad</th>
    <th>Precio</th>
  </tr>
</table>
<hr/>
<h3>Total:
<label id="total" type="number"></label>
</h3>
<a href="index.html">Menu</a>

<script>
var fs = require('fs');
(function($) {
      // Leer
    fs.readFile('data.json', function (err, products) {
    if (err) throw err;
    var myObject = eval('(' + products + ')');
    var total = 0;
  $('#form1').on('submit', function(event) {
      event.preventDefault();
      var tablaDatos= $("#tblDatos");
      var code_product = $("#code_product").val();
      var resp = false;
         for(var cont=0;cont<myObject.length;cont++)
         {
             if (code_product == myObject[cont].code)
             {
                 if (myObject[cont].amount <= 0) alert("Producto Agotado");
                 tablaDatos.append("<tr><td>"+myObject[cont].code+"</td><td>"+myObject[cont].name+"</td><td>"+1+"</td><td>"+myObject[cont].price+"</td></tr>");
                 myObject[cont].amount = myObject[cont].amount - 1;
                 total = total + parseInt(myObject[cont].price);
                 $("#total").text(total);
                 resp=true;
                 break;
             }
         }
             if (resp == false) alert("Producto Inexistente");

     });
});
})(jQuery);
</script>
</body>
</html>
